<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Yajhfc-user] cannot print
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/yajhfc-user/2008-October/index.html" >
   <LINK REL="made" HREF="mailto:yajhfc-user%40lists.berlios.de?Subject=Re%3A%20%5BYajhfc-user%5D%20cannot%20print&In-Reply-To=%3CMahogany-0.67.2-14894-20081021-205532.00%40nerijus.sat.lt%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000103.html">
   <LINK REL="Next"  HREF="000098.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Yajhfc-user] cannot print</H1>
    <B>Nerijus Baliunas</B> 
    <A HREF="mailto:yajhfc-user%40lists.berlios.de?Subject=Re%3A%20%5BYajhfc-user%5D%20cannot%20print&In-Reply-To=%3CMahogany-0.67.2-14894-20081021-205532.00%40nerijus.sat.lt%3E"
       TITLE="[Yajhfc-user] cannot print">nerijus at users.sourceforge.net
       </A><BR>
    <I>Tue Oct 21 19:55:32 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000103.html">[Yajhfc-user] cannot print
</A></li>
        <LI>Next message: <A HREF="000098.html">[Yajhfc-user] YAJHFC With Hylafax 4.5 CVS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#105">[ date ]</a>
              <a href="thread.html#105">[ thread ]</a>
              <a href="subject.html#105">[ subject ]</a>
              <a href="author.html#105">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 21 Oct 2008 20:03:11 +0300 Nerijus Baliunas &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/yajhfc-user">nerijus at users.sourceforge.net</A>&gt; wrote:

&gt;<i> I added Wscript.echo javaexe &amp; &quot; -Duser.home=&quot;&quot;&quot; &amp; userprofile &amp; &quot;&quot;&quot; &quot; &amp; yjargs
</I>&gt;<i> before Set java = WshShell.Exec(javaexe &amp; &quot; -Duser.home=&quot;&quot;&quot; &amp; userprofile &amp; &quot;&quot;&quot; &quot; &amp; yjargs)
</I>
I changed to Set java = WshShell.Exec(javaexe &amp; &quot; -Duser.home=&quot; &amp; userprofile &amp; &quot; &quot; &amp; yjargs)
and now yajhfc launches, but it hangs. C:\yajhfc.log is empty, redmon log:

Microsoft (R) Windows Script Host Version 5.7
Copyright (C) Microsoft Corporation. All rights reserved.

C:\Program Files\Java\jre1.6.0_07\bin\java.exe -Duser.home=Z:\ -jar &quot;C:\Program Files\YajHFC\yajhfc.jar&quot; --stdin --debug --logfile=c:\yajhfc.log
Error #-2147024664: 
Error #-2147024664: 
Error #-2147024664: 
Error #-2147024664: 
Error #-2147024664: 
Error #-2147024664: 
2008.10.21 20.46.13 yajhfc.Launcher main
INFO: No old instance found, creating lock...
2008.10.21 20.46.13 yajhfc.Launcher main
INFO: Lock and listener created.
2008.10.21 20.46.13 yajhfc.FaxOptions loadFromFile
INFO: Loading prefs from Z:\.yajhfc\settings
2008.10.21 20.46.13 yajhfc.readstate.PersistentReadState getCurrent
INFO: Using persistence method local with Config &quot;null&quot;.
2008.10.21 20.46.14 yajhfc.util.SafeJFileChooser setup
WARNING: Original setup method failed:
java.lang.RuntimeException: java.io.IOException: Could not get shell folder ID list
	at sun.awt.shell.Win32ShellFolderManager2$ComInvoker.invoke(Unknown Source)
	at sun.awt.shell.Win32ShellFolder2.getFileSystemPath(Unknown Source)
	at sun.awt.shell.Win32ShellFolderManager2.getRecent(Unknown Source)
	at sun.awt.shell.Win32ShellFolderManager2.get(Unknown Source)
	at sun.awt.shell.ShellFolder.get(Unknown Source)
	at sun.swing.WindowsPlacesBar.&lt;init&gt;(Unknown Source)
	at com.sun.java.swing.plaf.windows.WindowsFileChooserUI.updateUseShellFolder(Unknown Source)
	at com.sun.java.swing.plaf.windows.WindowsFileChooserUI.installComponents(Unknown Source)
	at javax.swing.plaf.basic.BasicFileChooserUI.installUI(Unknown Source)
	at com.sun.java.swing.plaf.windows.WindowsFileChooserUI.installUI(Unknown Source)
	at javax.swing.JComponent.setUI(Unknown Source)
	at javax.swing.JFileChooser.updateUI(Unknown Source)
	at javax.swing.JFileChooser.setup(Unknown Source)
	at yajhfc.util.SafeJFileChooser.setup(SafeJFileChooser.java:60)
	at javax.swing.JFileChooser.&lt;init&gt;(Unknown Source)
	at javax.swing.JFileChooser.&lt;init&gt;(Unknown Source)
	at yajhfc.util.SafeJFileChooser.&lt;init&gt;(SafeJFileChooser.java:39)
	at yajhfc.FileTextField.&lt;init&gt;(FileTextField.java:123)
	at yajhfc.OptionsWin$ExeFileTextField.&lt;init&gt;(OptionsWin.java:689)
	at yajhfc.OptionsWin.getPanelPaths(OptionsWin.java:627)
	at yajhfc.OptionsWin.getPanelCommon(OptionsWin.java:323)
	at yajhfc.OptionsWin.getTabMain(OptionsWin.java:301)
	at yajhfc.OptionsWin.getJContentPane(OptionsWin.java:250)
	at yajhfc.OptionsWin.initialize(OptionsWin.java:142)
	at yajhfc.OptionsWin.&lt;init&gt;(OptionsWin.java:686)
	at yajhfc.mainwin$1.actualActionPerformed(mainwin.java:475)
	at yajhfc.ExcDialogAbstractAction.actionPerformed(ExcDialogAbstractAction.java:67)
	at yajhfc.mainwin.reconnectToServer(mainwin.java:1242)
	at yajhfc.Launcher$NewInstRunner.run(Launcher.java:588)
	at java.awt.event.InvocationEvent.dispatch(Unknown Source)
	at java.awt.EventQueue.dispatchEvent(Unknown Source)
	at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
	at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
	at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
	at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
	at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
	at java.awt.EventDispatchThread.run(Unknown Source)
Caused by: java.io.IOException: Could not get shell folder ID list
	at sun.awt.shell.Win32ShellFolder2.getFileSystemPath0(Native Method)
	at sun.awt.shell.Win32ShellFolder2.access$900(Unknown Source)
	at sun.awt.shell.Win32ShellFolder2$8.call(Unknown Source)
	at sun.awt.shell.Win32ShellFolder2$8.call(Unknown Source)
	at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
	at java.util.concurrent.FutureTask.run(Unknown Source)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at sun.awt.shell.Win32ShellFolderManager2$ComInvoker$3.run(Unknown Source)
	at java.lang.Thread.run(Unknown Source)

It tries to get settings from Z:\.yajhfc\settings, but they are in
C:\Documents and Settings\username\.yajhfc, so using -Duser.home=homedrv &amp; homedir (Z:\)
is probably not a good idea.

Regards,
Nerijus

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000103.html">[Yajhfc-user] cannot print
</A></li>
	<LI>Next message: <A HREF="000098.html">[Yajhfc-user] YAJHFC With Hylafax 4.5 CVS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#105">[ date ]</a>
              <a href="thread.html#105">[ thread ]</a>
              <a href="subject.html#105">[ subject ]</a>
              <a href="author.html#105">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/yajhfc-user">More information about the Yajhfc-user
mailing list</a><br>
</body></html>
